/*!
 * vue-draggable-nested-tree v3.0.0-beta
 * (c) phphe <phphe@outlook.com> (https://github.com/phphe)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).vueDraggableNestedTree={})}(this,(function(t){"use strict";function e(t,e){return t(e={exports:{}},e.exports),e.exports}var r=e((function(t){function e(r){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=e=function(t){return typeof t}:t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(r)}t.exports=e})),n=e((function(t){function e(r){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},e(r)}t.exports=e}));var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=n(t)););return t};e((function(t){function e(r,n,i){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=e=Reflect.get:t.exports=e=function(t,e,r){var n=o(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}},e(r,n,i||r)}t.exports=e})),e((function(t){function e(r,n){return t.exports=e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e(r,n)}t.exports=e}));function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t};var d=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};e((function(t){var e=function(t){var e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function d(t,e,r,n){var o=e&&e.prototype instanceof s?e:s,i=Object.create(o.prototype),a=new _(n||[]);return i._invoke=function(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return E()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var d=b(a,r);if(d){if(d===c)continue;return d}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===c)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(t,r,a),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=d;var c={};function s(){}function u(){}function f(){}var h={};h[o]=function(){return this};var p=Object.getPrototypeOf,g=p&&p(p(w([])));g&&g!==e&&r.call(g,o)&&(h=g);var v=f.prototype=s.prototype=Object.create(h);function y(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function m(t){var e;this._invoke=function(n,o){function i(){return new Promise((function(e,i){!function e(n,o,i,a){var d=l(t[n],t,o);if("throw"!==d.type){var c=d.arg,s=c.value;return s&&"object"==typeof s&&r.call(s,"__await")?Promise.resolve(s.__await).then((function(t){e("next",t,i,a)}),(function(t){e("throw",t,i,a)})):Promise.resolve(s).then((function(t){c.value=t,i(c)}),(function(t){return e("throw",t,i,a)}))}a(d.arg)}(n,o,e,i)}))}return e=e?e.then(i,i):i()}}function b(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var n=l(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,c;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function w(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return u.prototype=v.constructor=f,f.constructor=u,f[a]=u.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===u||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},y(m.prototype),m.prototype[i]=function(){return this},t.AsyncIterator=m,t.async=function(e,r,n,o){var i=new m(d(e,r,n,o));return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},y(v),v[a]="Generator",v[o]=function(){return this},v.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=w,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var d=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(d&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(d){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,c):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:w(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}));var l=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t};function c(t){return"[object Array]"===Object.prototype.toString.call(t)}function s(t,e){return 1===arguments.length&&(e=t,t=0),Math.floor(Math.random()*(e-t+1)+t)}function u(t,e){for(var r,n=0;(r=t.indexOf(e))>-1;)t.splice(r,1),n++;return n}function f(t){var e=p(t),r=function(){if("undefined"!=typeof pageYOffset)return{top:pageYOffset,left:pageXOffset};var t=document.body,e=document.documentElement;return{top:(e=e.clientHeight?e:t).scrollTop,left:e.scrollLeft}}();return{x:e.left+r.left,y:e.top+r.top}}function h(t){for(var e=function(t){var e=t.offsetParent;return(!e||e===document.body&&"static"===getComputedStyle(document.body).position)&&(e=document.body.parentElement),e}(t),r={x:t.offsetLeft,y:t.offsetTop},n=t;(n=n.parentElement)!==e&&n;)r.x-=n.scrollLeft,r.y-=n.scrollTop;return r}function p(t){var e=t.getBoundingClientRect(),r=e.top-document.documentElement.clientTop,n=e.bottom,o=e.left-document.documentElement.clientLeft,i=e.right;return{top:r,right:i,bottom:n,left:o,width:e.width||i-o,height:e.height||n-r,x:o,y:r}}function g(t,e){t["original_".concat(e)]=t.getAttribute(e)}function v(t,e){var r="original_".concat(e);t.setAttribute(e,t[r])}function y(t,e){return t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className)}function m(t,e){y(t,e)||(t.classList?t.classList.add(e):t.className+=" "+e)}function b(t){g(t,"style"),t.style.display="block";var e=p(t),r={width:e.width,height:e.height};return v(t,"style"),r}function N(t,e,r){for(var n=arguments.length,o=new Array(n>3?n-3:0),i=3;i<n;i++)o[i-3]=arguments[i];t.addEventListener?t.addEventListener.apply(t,[e,r].concat(o)):t.attachEvent&&t.attachEvent.apply(t,["on".concat(e),r].concat(o))}function x(t,e,r){for(var n=arguments.length,o=new Array(n>3?n-3:0),i=3;i<n;i++)o[i-3]=arguments[i];t.removeEventListener?t.removeEventListener.apply(t,[e,r].concat(o)):t.detachEvent&&t.detachEvent.apply(t,["on".concat(e),r].concat(o))}function _(t,e,r,n,o){var i,a,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1e3;null==r&&(r=0,n=t.length-1);for(var l,c=0;r>=0&&r<=n;){if(c>=d)throw Error("binarySearch: loop times is over ".concat(d,", you can increase the limit."));if((l=e(a=t[i=Math.floor((n-r)/2+r)],c))>0)n=i-1;else{if(!(l<0))return{index:i,value:a,count:c+1,hit:!0};r=i+1}c++}return o?{index:i,value:a,count:c+1,hit:!1,bigger:l>0}:null}var w="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)};function E(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function T(t,e){var r=arguments[3],n=c(t)?t:[t],o=n.map((function(t,e){return{item:t,index:e}}));r&&o.reverse();for(var i=function(){var t=o.shift(),n=t.item,i=t.index,a=t.parent,d=e(n,i,a);if(!1===d)return{v:void 0};if("skip children"===d)return"continue";if("skip siblings"===d&&(o=o.filter((function(t){return t.parent!==a}))),n.children){var l,c=n.children;r&&(c=c.slice()).reverse();var s=c.map((function(t,e){return{item:t,index:e,parent:n}}));(l=o).push.apply(l,E(s))}};o.length;){var a=i();switch(a){case"continue":continue;default:if("object"===(void 0===a?"undefined":w(a)))return a.v}}}function O(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"parent";t[n]&&u(t[n][r],t),t[n]=e}function S(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"parent";if(t!==e){var o=e[n],i=o[r],a=i.indexOf(e);i[a+1]!==t&&(t[n]===e[n]?(u(i,t),a=i.indexOf(e)):O(t,e[n]),i.splice(a+1,0,t))}}function P(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children";if(t===e)throw"can't append to self";var n=e[r],o=n[n.length-1];o!==t&&(O(t,e),n.push(t))}function k(t,e,r,n,o,i,a,d,l,c){"boolean"!=typeof a&&(l=d,d=a,a=!1);var s,u="function"==typeof r?r.options:r;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,o&&(u.functional=!0)),n&&(u._scopeId=n),i?(s=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(i)},u._ssrRegister=s):e&&(s=a?function(t){e.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,d(t))}),s)if(u.functional){var f=u.render;u.render=function(t,e){return s.call(e),f(t,e)}}else{var h=u.beforeCreate;u.beforeCreate=h?[].concat(h,s):[s]}return r}var C={name:"TreeNode",props:{data:{},store:{},level:{default:0}},data:function(){return{vm:this}},computed:{childrenLevel:function(){return this.level+1},isRoot:function(){return this.data&&this.data.isRoot},childrenVisible:function(){var t=this.data;return this.isRoot||t&&t.children&&t.children.length&&t.open},innerBackStyle:function(){var t={marginBottom:this.store.space+"px"};return!this.isRoot&&this.level>1&&(t.paddingLeft=(this.level-1)*this.store.indent+"px"),t}},watch:{data:{immediate:!0,handler:function(t){t&&(t._vm=this,t._treeNodePropertiesCompleted||t.isRoot||this.store.compeleteNode(t,this.$parent.data))}}}},L=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tree-node",class:[t.data.active?t.store.activatedClass:"",t.data.open?t.store.openedClass:"",t.data.class],style:t.data.style,attrs:{id:t.data._id}},[t.isRoot?t._e():t._t("node-inner-back",[r("div",{staticClass:"tree-node-inner-back",class:[t.data.innerBackClass],style:[t.innerBackStyle,t.data.innerBackStyle]},[r("div",{staticClass:"tree-node-inner",class:[t.data.innerClass],style:[t.data.innerStyle]},[t._t("default",null,{data:t.data,store:t.store,vm:t.vm})],2)])],{styleObj:t.innerBackStyle,data:t.data,store:t.store,vm:t.vm}),r("transition",{attrs:{name:t.store.childrenTransitionName}},[t.childrenVisible?r("div",{staticClass:"tree-node-children"},t._l(t.data.children,(function(e){return r("TreeNode",{key:e._id,attrs:{data:e,store:t.store,level:t.childrenLevel},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("default",null,{data:e.data,store:e.store,vm:e.vm})]}},{key:"node-inner-back",fn:function(e){return t.store.customInnerBack?[t._t("node-inner-back",null,{styleObj:e.styleObj,data:e.data,store:e.store,vm:e.vm})]:void 0}}],null,!0)})})),1):t._e()])],2)};L._withStripped=!0;var D=k({render:L,staticRenderFns:[]},void 0,C,void 0,!1,void 0,!1,void 0,void 0,void 0),j={props:{data:{},idLength:{type:Number,default:5},indent:{type:Number,default:16},activatedClass:{default:"active"},openedClass:{default:"open"},space:{type:Number,default:10},childrenTransitionName:{},customInnerBack:{}},components:{TreeNode:D},data:function(){return{store:this,rootData:null}},watch:{data:{immediate:!0,handler:function(t,e){var r=this;t!==e&&(this.rootData=this.rootData||{isRoot:!0,_id:"tree_".concat(this._uid,"_node_root"),children:[]},T(t,(function(t,e,n){r.compeleteNode(t,n)})),this.rootData.children=t)}}},methods:{compeleteNode:function(t,e){var r={open:!0,children:[],active:!1,style:{},class:"",innerStyle:{},innerClass:"",innerBackStyle:{},innerBackClass:{}};for(var n in r)t.hasOwnProperty(n)||this.$set(t,n,r[n]);this.$set(t,"parent",e||this.rootData),t.hasOwnProperty("_id")||(t._id="tree_".concat(this._uid,"_node_").concat(function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<t;o++)r+=n[s(n.length-1)];return e+r}(this.idLength))),t._treeNodePropertiesCompleted=!0},pure:function(t,e,r){var n=this,o=Object.assign({},t);delete o._id,delete o.parent,delete o.children,delete o.open,delete o.active,delete o.style,delete o.class,delete o.innerStyle,delete o.innerClass,delete o.innerBackStyle,delete o.innerBackClass;for(var i=0,a=Object.keys(o);i<a.length;i++){var d=a[i];"_"===d[0]&&delete o[d]}return e&&t.children&&(o.children=t.children.slice(),o.children.forEach((function(t,r){o.children[r]=n.pure(t,e)}))),r&&r(o,t)||o},getNodeById:function(t){var e;return T(this.rootData.children,(function(r){if(r._id===t)return e=r,!1})),e},getActivated:function(){var t=[];return T(this.rootData.children,(function(e){e.active&&t.push(e)})),t},getOpened:function(){var t=[];return T(this.rootData.children,(function(e){e.open&&t.push(e)})),t},activeNode:function(t,e){this.activated;e&&this.getActivated().forEach((function(t){t.active=!1})),t.active=!0},toggleActive:function(t,e){t.active?t.active=!1:this.activeNode(t,e)},openNode:function(t,e){var r=this;this.opened;e&&this.getOpened().forEach((function(t){t.open=!1,r.$emit("nodeOpenChanged",t)})),t.open=!0,this.$emit("nodeOpenChanged",t)},toggleOpen:function(t,e){t.open?(t.open=!1,this.$emit("nodeOpenChanged",t)):this.openNode(t,e)},getPureData:function(t){return this.pure(this.rootData,!0,t).children},deleteNode:function(t){return u(t.parent.children,t)}}},R=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"he-tree tree"},[r("TreeNode",{attrs:{data:t.rootData,store:t.store},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("default",null,{data:e.data,store:t.store,vm:e.vm})]}},{key:"node-inner-back",fn:function(e){return t.customInnerBack?[t._t("node-inner-back",null,{styleObj:e.styleObj,data:e.data,store:e.store,vm:e.vm})]:void 0}}],null,!0)})],1)};R._withStripped=!0;var B=k({render:R,staticRenderFns:[]},void 0,j,void 0,!1,void 0,!1,void 0,void 0,void 0),I={start:["mousedown","touchstart"],move:["mousemove","touchmove"],end:["mouseup","touchend"]},$={isTouch:function(t){return t.type&&t.type.startsWith("touch")},_getStore:function(t){return t._wrapperStore||(t._wrapperStore=[]),t._wrapperStore},on:function(t,e,r){var n,o,i=this._getStore(t),a=this,d=function(t){var n;if(a.isTouch(t))n={x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY};else if(n={x:t.pageX,y:t.pageY},"start"===e&&1!==t.which)return;return r.call(this,t,n)};i.push({handler:r,wrapper:d});for(var l=arguments.length,c=new Array(l>3?l-3:0),s=3;s<l;s++)c[s-3]=arguments[s];(n=N).call.apply(n,[null,t,I[e][0],d].concat(c)),(o=N).call.apply(o,[null,t,I[e][1],d].concat(c))},off:function(t,e,r){for(var n=this._getStore(t),o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];for(var d=n.length-1;d>=0;d--){var l,c,s=n[d],u=s.handler,f=s.wrapper;if(r===u)(l=x).call.apply(l,[null,t,I[e][0],f].concat(i)),(c=x).call.apply(c,[null,t,I[e][1],f].concat(i)),n.splice(d,1)}}};var A=function(){function t(){d(this,t),l(this,"store",{})}return a(t,[{key:"has",value:function(t){return this.store.hasOwnProperty(t)}},{key:"remember",value:function(t,e){return this.has(t)||(this.store[t]={value:e()}),this.store[t].value}},{key:"forget",value:function(t){t?this.has(t)&&delete this.store[t]:this.store={}}}]),t}();function F(t){return""===t||t}function H(t,e){for(var r=t;r;)if((r=r.parentNode)===e)return!0}document.elementsFromPoint||(document.elementsFromPoint=function(t,e){var r=[],n=void 0;do{n!==document.elementFromPoint(t,e)?(n=document.elementFromPoint(t,e),r.push(n),n.style.pointerEvents="none"):n=!1}while(n);return r.forEach((function(t){return t.style.pointerEvents="all"})),r});var M=function(t){},G=function(t){z(t.dplh,t.targetNode)},V=function(t){K(t.targetNode.parent)?function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"parent";if(t!==e){var o=e[n][r],i=o.indexOf(e);o[i-1]!==t&&(t[n]===e[n]?(u(o,t),i=o.indexOf(e)):O(t,e[n]),o.splice(i,0,t))}}(t.dplh,t.targetNode):z(t.dplh,t.targetNode.parent)},Y=function(t){K(t.targetNode)?(P(t.dplh,t.targetNode),t.targetNode.open||t.store.toggleOpen(t.targetNode)):z(t.dplh,t.targetNode)},q=function(t){K(t.targetNode)?(!function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children";if(t===e)throw"can't prepend to self";var n=e[r];n[0]!==t&&(O(t,e),n.splice(0,0,t))}(t.dplh,t.targetNode),t.targetNode.open||t.store.toggleOpen(t.targetNode)):z(t.dplh,t.targetNode)},X=function(t){z(t.dplh,t.targetNode.parent)},W=function(t){K(t.targetPrev)?(P(t.dplh,t.targetPrev),t.targetPrev.open||t.store.toggleOpen(t.targetPrev)):z(t.dplh,t.targetPrev)},U=function(t){K(t.currentTree.rootData)&&P(t.dplh,t.currentTree.rootData)};function z(t,e,r){if(!e)return!1;var n=function(t,e){var r=t;for(;r;){if(e(r))return r;r=r.parent}}(e,(function(t){return t.parent&&K(t.parent)}));return!!n&&(S(t,n),!0)}function J(t){var e;it.hasOwnProperty(t._id)||(e=t.hasOwnProperty("draggable")?t.draggable:!t.parent||J(t.parent),it[t._id]=e);return it[t._id]}function K(t){var e;ot.hasOwnProperty(t._id)||(e=t.hasOwnProperty("droppable")?t.droppable:!t.parent||K(t.parent),ot[t._id]=e);return ot[t._id]}function Q(t,e,r,n){var o=e.length;if(n)for(var i=o-1;i>=0;i--){var a=e[i];if(a!==t.node&&r(a,i))return a}else for(var d=0;d<o;d++){var l=e[d];if(l!==t.node&&r(l,d))return l}}for(var Z,tt={"targetNode existed":function(t){return t.targetNode},"targetNode is placeholder":function(t){return t.targetNode.isDragPlaceHolder},"targetNode at top":function(t){return t.targetAtTop},"targetNode at bottom":function(t){return t.targetAtBottom},"targetNode is the second child of root":function(t){return t.currentTreeRootSecondChildExcludingDragging===t.targetNode},"currentTree existed":function(t){return t.currentTree},"currentTree empty":function(t){return!Q(t,t.currentTree.rootData.children,(function(t){return t}))},"placeholder existed":function(t){return t.dplhEl},"placeholder in currentTree":function(t){return t.dplhElInCurrentTree},"placeholder at top":function(t){return t.dplhAtTop},"targetNode is open":function(t){return t.targetNode.open},"targetNode has children excluding placeholder":function(t){return Q(t,t.targetNode.children,(function(e){return e!==t.dplh}))},"targetNode is 1st child":function(t){return Q(t,t.targetNode.parent.children,(function(t){return t}))===t.targetNode},"targetNode is last child":function(t){return Q(t,t.targetNode.parent.children,(function(t){return t}),!0)===t.targetNode},"on targetNode middle":function(t){return t.offset.y<=t.tiMiddleY},"at left":function(t){return t.offset.x<t.tiOffset.x},"at indent right":function(t){return t.offset.x>t.tiOffset.x+t.currentTree.indent}},et=function(){var t=nt[rt],e=tt[t];tt[t]=function(){return Boolean(e.apply(void 0,arguments))}},rt=0,nt=Object.keys(tt);rt<nt.length;rt++)et();var ot={},it={};function at(t){var e=this.store.trees,r=t.store,n={event:t.event,el:r.el,vm:this,node:this.data,store:this.store,dplh:this.store.dplh,draggableHelperData:{opt:t.options,store:r}};!function(t,e,r){var n=function(n){Object.defineProperty(t,n,{get:function(){var t=this;return e.remember(n,(function(){return r[n].call(t)}))}})};for(var o in r)n(o)}(n,new A,{nodeInnerEl:function(){return this.el.querySelector(".tree-node-inner")},offset:function(){return f(this.nodeInnerEl)},offset2:function(){return{x:this.offset.x+this.nodeInnerEl.offsetWidth,y:this.offset.y+this.nodeInnerEl.offsetHeight}},offsetToViewPort:function(){var t=this.nodeInnerEl.getBoundingClientRect();return t.x=t.left,t.y=t.top,t},currentTree:function(){var t=function(t,e,r){var n,o,i=document.elementsFromPoint(t,e),a=[],d=!0,l=!1,c=void 0;try{for(var s,u=i[Symbol.iterator]();!(d=(s=u.next()).done);d=!0){var f=s.value;if(o){if(y(f,"tree")){n=f;break}a.push(f)}else y(f,"tree-node")&&(o=f)}}catch(t){l=!0,c=t}finally{try{d||null==u.return||u.return()}finally{if(l)throw c}}if(n){var h=!1;if(!H(o,n)){var p=!0,g=!1,v=void 0;try{for(var m,b=a[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){if(!H(m.value,n)){h=!0;break}}}catch(t){g=!0,v=t}finally{try{p||null==b.return||b.return()}finally{if(g)throw v}}}if(!h)return r.find((function(t){return t.$el===n}))}}(this.offsetToViewPort.x,this.offsetToViewPort.y,e);if(t){var r=this.store;if(null==Z&&(Z=r),Z!==t){if(!F(r.crossTree)||!F(t.crossTree))return;Z=t}if(!F(t.droppable))return;return t}},currentTreeRootEl:function(){return document.getElementById(this.currentTree.rootData._id)},currentTreeRootOf4:function(){return dt(this.currentTreeRootEl,this.currentTree.space)},currentTreeRootSecondChildExcludingDragging:function(){var t=this;return this.currentTree.rootData.children.slice(0,3).filter((function(e){return e!==t.node}))[1]},dplhEl:function(){return document.getElementById(this.dplh._id)},dplhElInCurrentTree:function(){return Boolean(this.currentTree.$el.querySelector("#".concat(this.dplh._id)))},dplhOf4:function(){return dt(this.dplhEl,this.currentTree.space)},dplhAtTop:function(){return Math.abs(this.dplhOf4.y-this.currentTreeRootOf4.y)<5},targetAtTop:function(){return Math.abs(this.tiOf4.y-this.currentTreeRootOf4.y)<5},targetAtBottom:function(){return Math.abs(this.tiOf4.y2-this.currentTreeRootOf4.y2)<5},targetNode:function(){var t=this.currentTree;if(!t)throw"no currentTree";for(var e=this.offset,r=(e.x,e.y),n=t.rootData;;){var o=n.children;if(!o)break;if(this.node.parent===n&&(o=o.slice()).splice(o.indexOf(this.node),1),0===o.length)break;var i=_(o,(function(e){var n=document.getElementById(e._id),o=f(n).y;return o+n.offsetHeight+t.space<r?-1:o<=r?0:1}),null,null,!0);if(!(n=i.hit?i.value:i.bigger?o[i.index-1]:i.value)){n=o[0];break}if(!n)break;var a=dt(document.getElementById(n._id).querySelector(".tree-node-inner"),t.space);if(a.y<=r&&r<=a.y2)break}return n},targetNodeEl:function(){return document.getElementById(this.targetNode._id)},tiInnerEl:function(){return this.targetNodeEl.querySelector(".tree-node-inner")},tiOffset:function(){return f(this.tiInnerEl)},tiOf4:function(){return dt(this.tiInnerEl,this.currentTree.space)},tiMiddleY:function(){return this.tiOffset.y+this.tiInnerEl.offsetHeight/2},targetPrevEl:function(){var t=this.targetNodeEl.previousSibling;return y(t,"dragging")&&(t=t.previousSibling),t},targetPrev:function(){var t=this.targetPrevEl.getAttribute("id");return this.currentTree.getNodeById(t)}});var o={},i=function(t){if(!o.hasOwnProperty(t)){var e;try{e=tt[t](n)}catch(r){e=r;try{process.env.DEVELOPE_SELF&&console.warn("failed to execute rule '".concat(t,"'"),r)}catch(t){}}o[t]=e}return o[t]};!0===i("currentTree existed")?!1===i("targetNode is placeholder")?!0===i("targetNode is the second child of root")?!1===i("targetNode has children excluding placeholder")?!0===i("on targetNode middle")?V(n):!1===i("on targetNode middle")&&(!0===i("at indent right")?Y(n):!1===i("at indent right")&&G(n)):!0===i("targetNode has children excluding placeholder")&&q(n):!1===i("targetNode is the second child of root")&&(!1===i("currentTree empty")?!0===i("targetNode at top")?!0===i("placeholder in currentTree")?!1===i("targetNode has children excluding placeholder")?!1===i("on targetNode middle")?!1===i("at indent right")?G(n):!0===i("at indent right")&&Y(n):!0===i("on targetNode middle")&&V(n):!0===i("targetNode has children excluding placeholder")&&(!1===i("on targetNode middle")?q(n):!0===i("on targetNode middle")&&V(n)):!1===i("placeholder in currentTree")&&V(n):!1===i("targetNode at top")&&(!1===i("targetNode at bottom")?!0===i("placeholder at top")?q(n):!1===i("placeholder at top")&&(!0===i("targetNode has children excluding placeholder")?q(n):!1===i("targetNode has children excluding placeholder")&&(!1===i("targetNode is 1st child")?!1===i("targetNode is last child")?!0===i("on targetNode middle")?!0===i("at indent right")?Y(n):!1===i("at indent right")&&G(n):!1===i("on targetNode middle")&&(!0===i("at indent right")?Y(n):!1===i("at indent right")&&G(n)):!0===i("targetNode is last child")&&(!0===i("at indent right")?Y(n):!1===i("at indent right")&&G(n)):!0===i("targetNode is 1st child")&&(!0===i("targetNode is last child")?Y(n):!1===i("targetNode is last child")&&(!1===i("on targetNode middle")?!1===i("at indent right")?G(n):!0===i("at indent right")&&Y(n):!0===i("on targetNode middle")&&(!1===i("at indent right")?G(n):!0===i("at indent right")&&Y(n)))))):!0===i("targetNode at bottom")&&(!0===i("placeholder in currentTree")?!1===i("on targetNode middle")?!0===i("at indent right")?Y(n):!1===i("at indent right")&&G(n):!0===i("on targetNode middle")&&Y(n):!1===i("placeholder in currentTree")&&Y(n))):!0===i("currentTree empty")&&U(n)):!0===i("targetNode is placeholder")&&(!1===i("targetNode at bottom")?!1===i("targetNode is the second child of root")?!0===i("targetNode is 1st child")?!1===i("targetNode is last child")?M(n):!0===i("targetNode is last child")&&(!1===i("on targetNode middle")?!0===i("at left")?X(n):!1===i("at left")&&M(n):!0===i("on targetNode middle")&&(!0===i("at left")?X(n):!1===i("at left")&&M(n))):!1===i("targetNode is 1st child")&&(!0===i("targetNode is last child")?!0===i("on targetNode middle")?!0===i("at left")?X(n):!1===i("at left")&&(!0===i("at indent right")?W(n):!1===i("at indent right")&&M(n)):!1===i("on targetNode middle")&&(!0===i("at left")?X(n):!1===i("at left")&&(!0===i("at indent right")?W(n):!1===i("at indent right")&&M(n))):!1===i("targetNode is last child")&&(!0===i("on targetNode middle")?!0===i("at left")?M(n):!1===i("at left")&&(!0===i("at indent right")?W(n):!1===i("at indent right")&&M(n)):!1===i("on targetNode middle")&&(!0===i("at left")?M(n):!1===i("at left")&&(!0===i("at indent right")?W(n):!1===i("at indent right")&&M(n))))):!0===i("targetNode is the second child of root")&&(!0===i("on targetNode middle")?!0===i("at indent right")?W(n):!1===i("at indent right")&&M(n):!1===i("on targetNode middle")&&(!0===i("at indent right")?W(n):!1===i("at indent right")&&M(n))):!0===i("targetNode at bottom")&&(!0===i("targetNode is 1st child")?!1===i("on targetNode middle")?!0===i("at left")?X(n):!1===i("at left")&&M(n):!0===i("on targetNode middle")&&(!1===i("at left")?M(n):!0===i("at left")&&X(n)):!1===i("targetNode is 1st child")&&(!1===i("on targetNode middle")?!0===i("at left")?X(n):!1===i("at left")&&(!0===i("at indent right")?W(n):!1===i("at indent right")&&M(n)):!0===i("on targetNode middle")&&(!0===i("at left")?X(n):!1===i("at left")&&(!0===i("at indent right")?W(n):!1===i("at indent right")&&M(n)))))):!1===i("currentTree existed")&&M(n)}function dt(t,e){var r=f(t);return r.x2=r.x+t.offsetWidth,r.y2=r.y+t.offsetHeight+e,r}at.dragStart=function(){},at.dragEnd=function(){Z=null,ot={},it={}};var lt=k({},void 0,{extends:D,name:"TreeNode",mounted:function(){var t=this;if(this.store.isNodeDraggable=J,this.store.isNodeDroppable=K,!this.isRoot&&!this.data.isDragPlaceHolder){var e=this.store.dplh;this.$watch("store.draggable",(function(r){if(F(r)){var n=t.store.getTriggerEl?t.store.getTriggerEl(t):t.$el.querySelector(".tree-node-inner");t._draggableDestroy=
/*!
	 * draggable-helper v1.0.20
	 * (c) 2018-present phphe <phphe@outlook.com> (https://github.com/phphe)
	 * Released under the MIT License.
	 */
function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null==e.minTranslate&&(e.minTranslate=10);var r={movedCount:0},n=function(){$.off(t,"end",t._draggbleEventHandler),x(t,"selectstart",c),delete t._draggbleEventHandler};return t._draggbleEventHandler&&n(),t._draggbleEventHandler=o,$.on(t,"start",t._draggbleEventHandler),N(t,"selectstart",c),n;function o(t,e){r.mouse={x:e.x,y:e.y},r.initialMouse=Object.assign({},r.mouse),$.on(document,"move",a,{passive:!1}),$.on(window,"end",d)}function i(t){var n=l(),o=n.el,i=n.position;if(r.el=o,r.initialPosition=Object.assign({},i),!1===(e.drag&&e.drag(t,e,r)))return!1;var a=b(o),d=Object.assign({width:"".concat(a.width,"px"),height:"".concat(a.height,"px"),zIndex:9999,opacity:.6,position:"absolute",left:i.x+"px",top:i.y+"px"},e.style||e.getStyle&&e.getStyle(e)||{});for(var c in g(o,"style"),d)o.style[c]=d[c];g(o,"class"),m(o,e.draggingClass)}function a(t,n){r.mouse={x:n.x,y:n.y};var o=r.move={x:r.mouse.x-r.initialMouse.x,y:r.mouse.y-r.initialMouse.y};if(0===r.movedCount&&e.minTranslate){var a=Math.pow(r.move.x,2),d=Math.pow(r.move.y,2);if(Math.pow(a+d,.5)<e.minTranslate)return}var l=!0;if(0===r.movedCount&&!1===i(t)&&(l=!1),t.preventDefault(),l&&e.moving&&!1===e.moving(t,e,r)&&(l=!1),l){if(!r||!r.el)return;Object.assign(r.el.style,{left:r.initialPosition.x+o.x+"px",top:r.initialPosition.y+o.y+"px"}),r.movedCount++}}function d(t){if($.off(document,"move",a,{passive:!1}),$.off(window,"end",d),r.movedCount>0){r.movedCount=0;var n=r.el;e.clone?n.parentElement.removeChild(n):(v(n,"style"),v(n,"class")),e.drop&&e.drop(t,e,r)}r={movedCount:0}}function l(){var n=e.getEl?e.getEl(t,e):t,o=n;return e.clone&&(r.triggerEl=n,o=n.cloneNode(!0),n.parentElement.appendChild(o)),{position:h(o),el:o}}function c(t){t.preventDefault()}}(n,{preventSelect:F(t.store.preventSelect),getEl:function(){return t.$el},minTranslate:10,drag:function(r,n,o){at.dragStart();var i={event:r,options:n,store:o};if(t.store.ondragstart&&!1===t.store.ondragstart(t.data,i))return!1;if(!J(t.data))return!1;t.store.$emit("drag",t.data);var a=t.data.parent.children;t.startPosition={siblings:a,index:a.indexOf(t.data)},e.innerStyle.height=o.el.offsetHeight+"px",S(e,t.data),t.data.class+=" dragging"},moving:function(e,r,n){if(0!==n.movedCount){var o={event:e,options:r,store:n};return at.call(t,o)}},drop:function(r,n,o){at.dragEnd();var i={event:r,options:n,store:o};if(t.store.ondragend&&!1===t.store.ondragend(t.data,i))u(e.parent.children,e);else{var a=e._vm.store,d=a!==t.store?t.store:null;S(t.data,e),u(e.parent.children,e),t.data.class=t.data.class.replace(/(^| )dragging( |$)/g," "),a.$emit("drop",t.data,a,d),d&&d.$emit("drop",t.data,a,d);var l=t.data.parent.children;l===t.startPosition.siblings&&l.indexOf(t.data)===t.startPosition.index||(t.store.$emit("change",t.data,a,d),d&&d.$emit("change",t.data,a,d)),t.startPosition=null}}})}else t._draggableDestroy&&(t._draggableDestroy(),t._draggableDestroy=null)}),{immediate:!0})}}},void 0,void 0,void 0,!1,void 0,void 0,void 0),ct=[],st={_id:"draggable_tree_drag_placeHolder",level:null,droppable:!1,isDragPlaceHolder:!0,class:"draggable-placeholder",style:{},innerStyle:{},innerClass:"draggable-placeholder-inner",innerBackStyle:{},innerBackClass:"draggable-placeholder-inner-back"},ut=k({},void 0,{extends:B,props:{getTriggerEl:{type:Function},draggable:{},droppable:{default:!0},crossTree:{},ondragstart:{type:Function},ondragend:{type:Function},preventSelect:{default:!0}},components:{TreeNode:lt},data:function(){return{dplh:st,trees:ct}},created:function(){ct.push(this)},mounted:function(){},beforeDestroy:function(){u(ct,this)}},void 0,void 0,void 0,!1,void 0,void 0,void 0);t.DraggableTree=ut,t.DraggableTreeNode=lt,t.Tree=B,t.TreeNode=D,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=vue-draggable-nested-tree.min.js.map
